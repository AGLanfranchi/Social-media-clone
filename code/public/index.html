<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home page</title>
    <link rel="stylesheet" href="/css/index.css">
</head>

<body>
    <main id = "mainBody">
        <header>
            <div id="logo">
                <img src="images/Lifeinvader Logo.png" alt="The logo" style="width:150px; height:70px;">
            </div>
        <nav aria-label="Main menu">
        <ul>
             <li>
            <a href="/login.html">Login
            </a>
             </li>
             <a href="/new-posts.html">Posts 
            </a>
            </li>
        </ul>
        </header>
    <h1>Home page</h1>

    <div id ="posts-container"></div>
    
    <button onclick="nextPage()">Load more...</button>

    <script>

        function showPost(post) {
            let template = document.getElementById("post-template")
            let container = document.getElementById("posts-container")

            let clone = template.content.firstElementChild.cloneNode(true)

            clone.getElementsByTagName('h2')[0].textContent = post.title
            clone.getElementsByClassName('body')[0].textContent = post.body

            container.appendChild(clone)
        }

        let itemsPerPage = 3
        let currentPage = 0

        function loadPosts() {
            let offset = itemsPerPage * currentPage

            fetch('/api/posts?offset=' + offset).then(response => {
                //Display the posts in the page
               
                response.json().then(result => {
                    console.log(result)
                    result.forEach(showPost)
                })
                // if (result.length == 0) {

                //     console.log()
                // } 
            })
        }

        function nextPage() {
            currentPage++
            loadPosts()
        }

        loadPosts()

        

0    </script>

        <template id="post-template">
            <div class="posts">
                <h2></h2>
                <div class="body"></div>
            </div>
        </template>


        <footer>
            <a href="q2b_dummy.html" tabindex="1">Copyright</a> | 
            <a href="q2b_dummy.html" tabindex="2">Privacy</a> | 
            <a href="q2b_dummy.html" tabindex="3">FAQs</a> | 
            <a href="q2b_dummy.html" tabindex="5">Conditions of use</a>
        </footer>

    </main>
    
</body>

    <!-- <script type= "text/javascript" src= "/js/index.js"></script> -->

</html>
