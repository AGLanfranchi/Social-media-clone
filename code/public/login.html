<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <link rel="stylesheet" href="login-page.css">
</head>

<body>
    <main id="mainBody">
        <h1>Login</h1>
         <a href="/index.html">Home</a>

        <div id="loginErrorMessage">
              <p id="errorMessage">Invalid username <span id ="message-second-line"> and/or password</span></p>
             </div>
    
             <form id="loginForm" name="loginForm">
                 <input id="username" type="text" name="username" class="login-form-field" placeholder="Username">
                 <input id="password" type="text" name="password" class="login-form-field" placeholder="Password">
                 <input id="login-form-submit" type="submit" value="Login"/>
            </form>

         <script type="text/javascript">
	        // Use fetch to call the  API

            function callApi(data) {
		        let url="/api/login"
             let options ={
                 method: "POST",
                 headers: {
                     "Content-Type" : "application/json"
                 },
                 body: JSON.stringify(data)
              }
    
		        return fetch(url, options).then(response => response.json());
	        }


            let form = document.getElementById("loginForm");
            let usernameInput = document.getElementById("username");
	        let passwordInput = document.getElementById("password");
            let loginButton = document.getElementById("login-form-submit");
            let loginErrorMessage = document.getElementById("loginErrorMessage");
    
         // Add submit event listener.
	        form.addEventListener("submit", (event) => { // changed from submit
	        	event.preventDefault();

                    // Capture the input values using FormData

                    let username = form.username.value;
                    let password  = form.password.value;

                    if (username === "admin@example.com" && password === "password") {
                        alert("You have successfuly loggin in.");
                        } else {
                        loginErrorMessage.style.opacity = 1;
                     }
                    
                        

                    /*
                    let data = new FormData(form);
		            let username = data.get("username");
                    let password = data.get("password");
                    */
        
                    callApi({"username": username, "password": password}).then(response =>{console.log(response)})


                     /*
                        if (loggedIn) {
                        text = 'Logged In as ' + sessionStorage.getItem('username')
                         document.getElementById('logoutLink').classList.remove('hidden')
                         }
                            else {
                            text = 'Logged Out'
                            document.getElementById('loginLink').classList.remove('hidden')
                            }
                    */
         });

        </script>
    </main>
</body>

</html>
