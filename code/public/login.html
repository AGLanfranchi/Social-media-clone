<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <link rel="stylesheet" href="login-page.css">
</head>

<body>
    <main id="mainBody">
        <h1>Login</h1>
         <a href="/index.html">Home</a>

        <div id="loginErrorMessage" class="hidden">
              <p id="errorMessage">Invalid username <span id ="messageSecondLine"> and/or password.</span></p>
             </div>

    
             <form id="loginForm" name="loginForm">
                 <input id="username" type="text" name="username" class="loginFormField" placeholder="Username" required>
                 <input id="password" type="text" name="password" class="loginFormField" placeholder="Password" required>
                 <input id="loginFormSubmit" type="submit" value="Login"/>
            </form>

         <script type="text/javascript">
	        // Use fetch to call the  API

            function callApi(data) {
		        let url="/api/login"
             let options ={
                 method: "POST",
                 headers: {
                     "Content-Type" : "application/json"
                 },
                 body: JSON.stringify(data)
              }
    
		        return fetch(url, options).then(response => response.json());
	        }


                    let formInput = document.getElementById("loginForm");
                    let loginButton = document.getElementById("login-form-submit");
                    
    
                    // Add submit event listener.
	                formInput.addEventListener("submit", (event) => { 
	        	         event.preventDefault();

                         // Capture the input values using FormData

                            let data = new FormData(formInput);
		                    let username = data.get("username");
                            let password = data.get("password");
                                
                         callApi({"username": username, "password": password})
                         .then(response => {

                            let loginErrorMsg = document.getElementById("loginErrorMessage");

                             if(!response) {
                                loginErrorMsg.classList.remove('hidden');
                             } else {
                                loginErrorMsg.classList.add('hidden');
                             }
                             
                         })



         });

        </script>
    </main>
</body>

</html>
